# Template file for 'laminar'
pkgname=laminar
version=1.3
revision=1
build_style=cmake
hostmakedepends="pkg-config capnproto"
makedepends="capnproto-devel rapidjson boost-devel sqlite-devel zlib-devel"
short_desc="Fast and lightweight Continuous Integration"
maintainer="danoloan10 <danoloan10@tutanota.com>"
license="GPL-3.0-only"
homepage="https://laminar.ohwg.net"
distfiles="https://github.com/ohwgiles/laminar/archive/refs/tags/${version}.tar.gz
 https://cdnjs.cloudflare.com/ajax/libs/vue/2.6.12/vue.min.js>vue.min.js
 https://raw.githubusercontent.com/drudru/ansi_up/v4.0.4/ansi_up.js>ansi_up.js
 https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js>chart.min.js"
checksum="764b903258e468c701b184523dfb7ee2058c77d7043167955f30124362018429
 29296ccacaa9ed35ed168fc51e36f54fd6f8db9c7786bbf38cc59a27229ba5c2
 996608ae1a80c64fb2b41e07f3ef1c4fc7ec437746c03867000de98686e5a8b7
 fbc45926e6b46845a0f905552a0e0b1331049bff1115ecf94dbe0904d895e710"
skip_extraction="vue.min.js ansi_up.js chart.min.js"

system_accounts="_laminar"
_laminar_homedir="/var/lib/laminar"
make_dirs="/var/lib/laminar 755 _laminar _laminar
 /var/lib/laminar/cfg 755 _laminar _laminar
 /var/lib/laminar/run 755 _laminar _laminar"

conf_files="/etc/laminar.conf"

pre_configure() {
	# Copy pre-downloaded JavaScript files to build directory
	# so CMake doesn't try to download them
	mkdir -p js
	vsrccopy vue.min.js ansi_up.js chart.min.js js/
}

post_install() {
	vconf etc/laminar.conf
	vsv laminar
}
